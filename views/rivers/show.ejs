<%- include('../partials/header') %>

  <section id="show">
    <div>
      <div id="divshow">Lake/River:</div>
      <div id="divshow">
        <%= river.title %>
      </div>
      <br><br>
      <div>
        <div id="divshow">Difficulty:</div>
        <div id="divshow">
          <%= river.difficulty %>
        </div>
        <br><br>
        <br><br>
        <div id="comment-div">
          <h2>Comments</h2>
          <% if (user) { %>
            <form id="add-comment-form" method="POST" action="/rivers/<%= river._id %>/comments">
              <label>Comment:</label>
              <textarea name="content"></textarea>
              <label>User Difficulty:</label>
              <select name="userDifficulty">
                <option value="Beginner" id="beg">Beginner</option>
                <option value="Intermediate" id="int">Intermediate</option>
                <option value="Expert" id="exp" selected>Expert</option>
              </select><br>
              <input type="submit" value="Add Comment">
            </form>
            <% } %> <br>
              <% if (river.comments.length) { %>
                <table>
                  <thead>
                    <tr>
                      <th>Date</th>
                      <th>Comments</th>
                      <th>User Difficulty</th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody id="tbody">
                    <% river.comments.forEach(function(c) { %>
                      <tr>
                        <td>
                          <%= c.createdAt.toLocaleDateString() %>
                        </td>
                        <td>
                          <%= c.content %>
                        </td>
                        <td>
                          <%= c.userDifficulty %>
                        </td>
                        <td>
                          <% if (user && user._id.equals(c.user)) { %>
                            <form action="/comments/<%= c._id %>?_method=PUT" method="POST">
                              <input name="content" id="review" value="<%= c.content %>">
                              <button type="submit">Update Comment</button>
                            </form>
                            <% } %>
                        </td>
                        <td>
                          <% if (user && user._id.equals(c.user)) { %>
                            <form action="/comments/<%= c._id %>?_method=DELETE" method="POST">
                              <button type="submit">X</button>
                            </form>
                            <% } %>
                        </td>
                      </tr>
                      <% }); %>
                  </tbody>
                </table>
                <% } else { %>
                  <h5><u><b>No Reviews Yet</b></u></h5>
                  <% } %>
        </div>
      </div>
    </div>
  </section>

  <%- include('../partials/footer') %>